# GASMailQueue

## 概要

* GoogleSpreadSheet用のスクリプトです
* リマインダーや作業報告管理として利用できます
* メール送信、Slack発言のどちらかを選択できます

## メールキューシートの準備

* メールキュー用に、下記のようなシートを作成する
  * 最初の2行はスクリプトが利用します

| <使い方> | | | | | | |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| 年月日 | 時分\* | 曜日 (0:日曜) | nの付く日 | 停止条件 | 件名\* | 本文\* |
| 2015/01/01 | 12:00 | | | | hello | world |

* 次の手順で、日付の入力補助を有効にする
  * A列を選択する
  * "データ"->"検証"を選択する
  * セル範囲を `<シート名>!A:A` から `<シート名>!A3:A` に変更する
  * 条件を `日付` `有効な日付` に設定する
  * 保存ボタンを押す

## 作業報告シートの準備

* 作業報告用に、下記のようなシートを作成する
  * 最初の2行はスクリプトが利用します

| 名前 | 体調 max3,min1 | 作業予定/報告 | 次回の作業予定 |
|:---:|:---:|:---:|:---:|
| system | | | |
| さかな | 2 | バグ修正 | 水槽の掃除 |

## スプレッドシートの設定

* "ツール"->"スクリプトエディタ"を選択し、`build/*.js` の内容を貼り付ける
  * `build/merged-config.js` の内容は適宜編集すること
* トリガーを適宜設定する
  * メールキューは1分毎、朝/夜の作業報告は10分毎、リセットは2-3時に一度、程度がよい

## メールキューの使い方

* 年月日, 曜日, nの付く日はいずれかひとつ必須です
  * この順に評価し、値が設定されているひとつめのモードで処理します
* 年月日モードで実行したときのみ、行が削除されます
* 書式は次の通りです, 年月日='2015/05/09', 時分='04:08', 曜日='12345'
* nの付く日に1を指定したとき、1,11,21,31日に実行します (10日は実行しません)
* 停止条件には、土日祝日は実行しない'dayoff'、祝日は実行しない'holiday'が指定できます

## SlackIncomingWebHooksモード

* IncomingWebHooksのURLを取得し、適宜設定することで、Slackに発言させることができます
* メールキューシートの"件名"は、発言先チャンネル名を意味するようになります
